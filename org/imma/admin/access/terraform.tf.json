{
  "data": {
    "terraform_remote_state": {
      "env": {
        "backend": "local",
        "config": {
          "path": "../.terraform/terraform.tfstate"
        }
      },
      "global": {
        "backend": "local",
        "config": {
          "path": "../../.terraform/terraform.tfstate"
        }
      }
    }
  },
  "module": {
    "app": {
      "app_name": "${var.app_name}",
      "az_count": "${var.az_count}",
      "env_remote_state": "${data.terraform_remote_state.env.config[\"path\"]}",
      "global_remote_state": "${data.terraform_remote_state.global.config[\"path\"]}",
      "source": "../../../../module/app"
    },
    "bastion": {
      "app_name": "${var.app_name}",
      "az_count": "${var.az_count}",
      "env_remote_state": "../.terraform/terraform.tfstate",
      "global_remote_state": "../../.terraform/terraform.tfstate",
      "instance_type": [
        "${lookup(var.instance_type,\"bastion\",\"t2.nano\")}"
      ],
      "public_key": "${var.public_key}",
      "public_network": "${lookup(var.public_network,\"bastion\",\"0\")}",
      "security_groups": [
        "${module.app.app_sg}"
      ],
      "service_name": "bastion",
      "service_nets": [
        "${data.terraform_remote_state.global.service_nets.bastion}"
      ],
      "source": "../../../../module/service",
      "user_data": "${var.user_data}",
      "want_fs": "${lookup(var.want_fs,\"bastion\",\"0\")}"
    },
    "openvpn": {
      "app_name": "${var.app_name}",
      "az_count": "${var.az_count}",
      "env_remote_state": "../.terraform/terraform.tfstate",
      "global_remote_state": "../../.terraform/terraform.tfstate",
      "instance_type": [
        "${lookup(var.instance_type,\"openvpn\",\"t2.nano\")}"
      ],
      "public_key": "${var.public_key}",
      "public_network": "${lookup(var.public_network,\"openvpn\",\"0\")}",
      "security_groups": [
        "${module.app.app_sg}"
      ],
      "service_name": "openvpn",
      "service_nets": [
        "${data.terraform_remote_state.global.service_nets.openvpn}"
      ],
      "source": "../../../../module/service",
      "user_data": "${var.user_data}",
      "want_fs": "${lookup(var.want_fs,\"openvpn\",\"0\")}"
    }
  },
  "output": {
    "app_sg": {
      "value": "${module.app.app_sg}"
    }
  },
  "provider": {
    "aws": {
      "region": "${data.terraform_remote_state.env.aws_region}"
    }
  },
  "variable": {
    "app_name": {
      "default": "access"
    },
    "az_count": {
      "default": "4"
    },
    "env_name": {
      "default": "admin"
    },
    "instance_type": {
      "default": {}
    },
    "public_key": {
      "default": "etc/ssh-key-pair.pub"
    },
    "public_network": {
      "default": {}
    },
    "user_data": {
      "default": "etc/user-data.template"
    },
    "want_fs": {
      "default": {}
    }
  }
}
